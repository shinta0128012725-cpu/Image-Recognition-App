# 画像分類Webアプリ（ResNet101 × Streamlit）

## 1. 概要

本プロジェクトは、事前学習済みのResNet101モデルを用いて画像分類を行うWebアプリケーションです。  
ImageNetで学習済みの重みを活用し、アップロードされた画像に対して1000クラスの分類予測を行います。

推論処理をStreamlitでWebアプリ化することで、機械学習モデルをユーザーが直感的に操作できる形で実装しています。

---

## 2. 使用技術

- Python
- PyTorch
- torchvision（ResNet101）
- PIL
- Streamlit
- NumPy

---

## 3. データについて

- ImageNet事前学習済みモデルを使用
- 1000クラス分類
- クラスラベルは `imagenet_classes.txt` を使用

本プロジェクトでは独自学習は行わず、転移学習済みモデルを推論用途で活用しています。

---

## 4. 前処理

ResNetの入力仕様に合わせて以下の前処理を実施：

- Resize(256)
- CenterCrop(224)
- ToTensor()
- Normalize(mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225])

学習時と同一の正規化パラメータを使用することで、推論精度を維持しています。

---

## 5. モデル構成

- モデル：ResNet101（事前学習済み）
- 出力：1000クラス
- 活性化関数：Softmax
- 推論モード：`model.eval()`

出力スコアに対してSoftmaxを適用し、確率順にソートして上位クラスを表示します。

---

## 6. 実装のポイント

### ① バッチ次元の追加
単一画像でもモデル入力形式（batch, channel, height, width）に合わせるため `unsqueeze` を使用。

### ② 推論専用モードへの切り替え
`model.eval()` を使用し、BatchNormやDropoutを推論モードへ変更。

### ③ Webアプリ化
Streamlitを使用し、機械学習モデルをインタラクティブに操作可能なUIとして実装。

---

## 7. 工夫した点

- 学習済みモデルの再利用により効率的な推論システムを構築
- 前処理パイプラインを明示的に定義し再現性を確保
- 推論結果を確率順に整列し、ユーザビリティを向上
- AIモデルとフロントエンドを分離し、実用的な構成に設計

---

## 8. 今後の改善案

- GPU対応による高速化
- 上位5クラスのみ表示するUI改善
- 推論時間の可視化
- 独自データでのファインチューニング
- Docker化によるデプロイ環境整備

---

## 9. 実行方法

```bash
pip install torch torchvision streamlit pillow
streamlit run app-2.py
